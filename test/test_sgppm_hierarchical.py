import numpy as np
from typing import List, Tuple
from ..peak_picking.building_block import BuildingBlock
from ..peak_picking.sgppm_hierarchical import HierarchicalSimpleGaussianPeakPickingModel
from ..peak_picking.sgppm_config import SGPPMConfig
from ..peak_picking.chromatogram import Chromatogram

hierarchy_data = {
    ('Leu', 'Phe', "Val"): "1395.00:45;36, 2625.00:5;4, 1695.00:25;16, 2415.00:19;13, 675.00:220;157, 3315.00:25;12, 2355.00:15;12, 2325.00:16;14, 3390.00:6;5, 1545.00:34;21, 1245.00:167;126, 915.00:209;134, 1515.00:32;28, 2655.00:16;10, 3135.00:16;11, 3285.00:24;10, 3255.00:7;4, 1215.00:311;224, 1575.00:45;29, 2835.00:7;4, 1365.00:58;46, 975.00:172;118, 1965.00:23;18, 2445.00:17;12, 1845.00:23;16, 1275.00:137;105, 2175.00:11;7, 645.00:251;187, 3105.00:6;3, 1095.00:167;120, 3045.00:17;8, 1755.00:17;13, 3015.00:17;13, 2685.00:24;13, 1335.00:91;72, 795.00:218;140, 1005.00:154;107, 1995.00:15;12, 1185.00:414;309, 945.00:144;106, 2475.00:11;9, 2055.00:13;9, 2385.00:15;10, 3510.00:19;9, 1785.00:23;18, 1635.00:19;13, 2115.00:17;12, 615.00:272;202, 2955.00:8;7, 705.00:252;153, 1725.00:28;23, 2535.00:10;7, 855.00:187;118, 2895.00:21;13, 2595.00:11;8, 3225.00:12;6, 1035.00:139;98, 735.00:211;156, 885.00:160;97, 1065.00:153;110, 1815.00:24;19, 3450.00:24;10, 2775.00:15;9, 2265.00:36;25, 3570.00:14;6, 1605.00:41;28, 1935.00:15;13, 2505.00:3;3, 3345.00:20;7, 1425.00:41;29, 1125.00:143;108, 2865.00:9;6, 1305.00:136;89, 1155.00:344;233, 2985.00:17;12, 3165.00:14;8, 2715.00:13;10, 2205.00:26;17, 2085.00:21;19, 765.00:227;151, 2745.00:14;10, 2805.00:14;12, 825.00:202;146, 2235.00:16;12, 1905.00:31;22, 2295.00:20;13, 3195.00:7;3, 2925.00:13;7, 1875.00:30;22, 3075.00:20;9, 1455.00:45;32, 2565.00:11;7, 2025.00:22;18, 2145.00:17;10, 1485.00:44;30, 1665.00:31;23",
    ('Leu', 'Phe', 'Null'): "1845.00:22;16, 2715.00:9;6, 1275.00:58;46, 1725.00:22;17, 795.00:154;101, 2745.00:5;4, 2865.00:13;7, 1215.00:355;248, 1935.00:19;12, 1305.00:64;48, 2175.00:14;8, 2235.00:25;16, 3570.00:14;10, 1665.00:18;15, 1185.00:611;480, 3135.00:5;5, 885.00:103;60, 3195.00:16;7, 1815.00:16;13, 855.00:112;83, 2595.00:19;11, 1245.00:142;102, 2805.00:16;11, 1065.00:122;86, 645.00:183;143, 2955.00:16;11, 2205.00:27;19, 975.00:117;89, 1755.00:25;19, 1635.00:31;23, 3075.00:16;5, 705.00:223;147, 1785.00:17;11, 1605.00:25;19, 945.00:80;59, 1395.00:37;32, 2505.00:11;7, 2985.00:13;6, 2415.00:16;11, 1455.00:44;30, 3105.00:17;6, 1545.00:26;24, 2925.00:11;7, 2655.00:14;7, 1965.00:16;13, 3345.00:7;2, 1005.00:127;86, 1575.00:34;24, 2385.00:16;9, 2835.00:8;7, 1875.00:13;9, 1425.00:37;29, 3315.00:9;3, 3015.00:9;8, 1095.00:134;96, 1125.00:189;139, 2055.00:19;17, 3165.00:12;4, 765.00:202;143, 735.00:233;158, 2265.00:11;6, 2325.00:15;12, 3045.00:7;5, 2895.00:9;5, 3225.00:29;8, 2355.00:16;9, 1365.00:44;33, 2025.00:22;16, 1335.00:37;26, 1485.00:28;20, 3390.00:11;7, 3255.00:18;9, 1155.00:459;308, 2295.00:18;13, 2685.00:5;4, 1035.00:83;64, 1695.00:29;19, 615.00:253;197, 3285.00:8;5, 2145.00:25;19, 825.00:105;74, 2445.00:10;6, 1515.00:29;19, 3450.00:13;11, 3510.00:9;4, 2475.00:11;10, 2625.00:11;5, 2775.00:9;9, 1905.00:14;11, 2565.00:6;3, 675.00:155;114, 2085.00:13;13, 2115.00:14;9, 2535.00:8;8, 915.00:99;63, 1995.00:18;11",
    ('Leu', 'Null', 'Phe'): "795.00:457;321, 1845.00:16;12, 3195.00:26;8, 2265.00:19;14, 2895.00:6;6, 2235.00:11;10, 2745.00:8;6, 1215.00:145;109, 615.00:143;104, 2535.00:7;7, 1095.00:72;55, 1245.00:78;57, 705.00:246;154, 1035.00:64;39, 1155.00:233;160, 945.00:88;55, 765.00:295;194, 3510.00:18;8, 1065.00:71;54, 1815.00:23;18, 1995.00:23;17, 2805.00:16;10, 2955.00:6;5, 2295.00:13;9, 3135.00:10;6, 3255.00:8;4, 2715.00:16;12, 855.00:170;111, 3390.00:9;2, 1425.00:23;14, 1635.00:15;13, 2415.00:18;16, 2175.00:14;7, 1485.00:28;18, 1665.00:29;19, 2115.00:14;10, 825.00:394;258, 2205.00:15;12, 2925.00:12;7, 1725.00:12;11, 2025.00:17;14, 1005.00:82;58, 3075.00:2;2, 1755.00:14;10, 3570.00:11;8, 1695.00:23;11, 2445.00:6;5, 3345.00:14;4, 1305.00:31;24, 1365.00:28;23, 675.00:146;99, 645.00:151;111, 1335.00:32;24, 1905.00:25;18, 1395.00:36;24, 2385.00:5;4, 2865.00:9;6, 1785.00:25;17, 885.00:151;92, 2355.00:6;5, 3450.00:4;2, 2685.00:10;6, 1455.00:30;21, 1515.00:29;17, 2475.00:10;5, 1275.00:38;28, 2085.00:9;9, 2835.00:15;9, 3285.00:11;6, 2775.00:23;13, 1185.00:252;178, 2145.00:13;10, 1935.00:18;11, 3105.00:12;7, 1545.00:23;20, 915.00:117;75, 3165.00:5;5, 1605.00:28;21, 735.00:172;112, 2505.00:9;6, 2325.00:10;7, 1575.00:24;18, 2595.00:14;10, 2565.00:13;8, 2655.00:14;9, 3315.00:3;2, 2625.00:4;4, 1125.00:93;65, 2055.00:16;8, 3015.00:10;5, 3225.00:13;6, 975.00:99;62, 1875.00:13;12, 3045.00:9;4, 1965.00:16;14, 2985.00:5;4",
    ('Null', 'Leu', 'Phe'): "615.00:456;354, 1995.00:51;34, 3165.00:27;13, 3075.00:23;10, 1875.00:67;48, 3045.00:37;18, 2985.00:24;14, 2625.00:20;12, 1785.00:54;42, 2685.00:23;17, 2865.00:24;10, 2295.00:43;30, 2415.00:29;20, 1275.00:151;102, 705.00:534;348, 1455.00:108;73, 2955.00:34;20, 1725.00:57;39, 3255.00:74;29, 765.00:582;377, 1575.00:92;56, 1935.00:78;49, 2025.00:59;38, 2505.00:36;26, 3345.00:37;17, 3105.00:38;18, 2385.00:39;30, 1905.00:45;39, 1695.00:60;47, 1185.00:915;669, 3285.00:43;22, 3315.00:58;17, 2805.00:57;33, 1665.00:53;40, 3450.00:35;22, 2445.00:17;15, 2085.00:65;40, 1545.00:84;61, 1245.00:258;186, 675.00:428;309, 3135.00:31;18, 2475.00:30;23, 2325.00:33;28, 915.00:298;203, 735.00:450;294, 1215.00:618;419, 1335.00:141;105, 3225.00:31;16, 2145.00:45;35, 1305.00:160;111, 1635.00:48;42, 2745.00:20;17, 2835.00:32;18, 2595.00:19;16, 3195.00:28;11, 2895.00:37;18, 1065.00:258;176, 2115.00:69;46, 3510.00:28;14, 855.00:363;252, 2535.00:27;21, 2775.00:41;26, 3570.00:40;25, 3390.00:28;14, 1095.00:274;178, 1365.00:96;70, 1125.00:311;200, 1035.00:204;138, 1395.00:93;66, 1605.00:106;71, 1515.00:91;72, 795.00:891;564, 3015.00:29;18, 1845.00:56;45, 1425.00:124;86, 2235.00:39;32, 1815.00:75;55, 2175.00:25;19, 2055.00:63;45, 2565.00:38;24, 1005.00:260;168, 825.00:562;369, 2655.00:29;18, 1755.00:51;38, 2715.00:27;22, 2205.00:58;41, 975.00:231;166, 645.00:412;300, 1485.00:112;75, 1155.00:765;507, 2265.00:39;28, 945.00:267;192, 885.00:328;183, 2355.00:50;28, 1965.00:48;38, 2925.00:22;13",
    ('Leu', 'Val', 'Null'): "2505.00:6;5, 2295.00:13;10, 1155.00:51;37, 2235.00:18;16, 855.00:178;129, 705.00:211;133, 1785.00:33;20, 1455.00:31;24, 2025.00:13;11, 2445.00:11;8, 2685.00:9;5, 3315.00:21;8, 2925.00:4;2, 645.00:270;200, 675.00:153;122, 1965.00:19;17, 2715.00:9;8, 1275.00:20;17, 2055.00:16;10, 1815.00:22;16, 2895.00:16;11, 615.00:359;263, 3390.00:12;8, 2775.00:18;13, 2985.00:13;8, 1545.00:32;22, 2745.00:3;3, 1905.00:20;15, 1065.00:79;58, 1725.00:29;25, 1995.00:9;7, 3345.00:17;9, 765.00:251;175, 2955.00:12;5, 3195.00:23;8, 1245.00:24;17, 735.00:245;152, 2805.00:5;4, 3045.00:7;6, 2115.00:7;5, 1515.00:16;14, 1335.00:27;25, 825.00:214;142, 1035.00:58;46, 2565.00:7;6, 3075.00:6;4, 1395.00:24;21, 3450.00:17;10, 1635.00:18;13, 2475.00:7;5, 3015.00:11;8, 2265.00:5;3, 2835.00:13;6, 1365.00:20;13, 1695.00:28;19, 1215.00:39;26, 1425.00:28;17, 1935.00:11;8, 2595.00:7;5, 1185.00:35;28, 975.00:140;102, 2175.00:2;2, 1485.00:29;22, 3510.00:11;7, 1665.00:14;11, 1575.00:26;17, 915.00:402;284, 1125.00:64;49, 2205.00:18;11, 3570.00:7;4, 885.00:265;152, 795.00:220;144, 2865.00:12;8, 1845.00:21;12, 3135.00:12;7, 2385.00:11;10, 945.00:359;265, 2145.00:20;12, 2415.00:6;6, 1605.00:22;14, 3105.00:5;4, 2355.00:20;13, 2625.00:4;3, 3225.00:16;6, 3255.00:15;8, 3165.00:14;5, 1305.00:33;22, 1005.00:100;80, 2535.00:15;11, 2085.00:12;10, 1095.00:67;47, 1875.00:18;17, 2325.00:9;8, 3285.00:14;6, 2655.00:5;3, 1755.00:13;12",
    ('Leu', 'Null', 'Val'): "1845.00:6;5, 1695.00:13;9, 1245.00:20;17, 1605.00:23;18, 1125.00:39;30, 3075.00:3;2, 3105.00:2;2, 2715.00:7;7, 1965.00:8;7, 2385.00:14;6, 1725.00:17;11, 735.00:216;152, 3135.00:10;6, 1875.00:21;18, 1515.00:21;16, 1785.00:18;17, 825.00:395;257, 1335.00:19;17, 2205.00:13;9, 1215.00:21;16, 975.00:114;82, 915.00:245;157, 2565.00:10;7, 1365.00:20;17, 2025.00:10;5, 2295.00:15;13, 1155.00:47;38, 2475.00:13;9, 2595.00:5;5, 765.00:298;197, 1395.00:15;12, 885.00:216;115, 1755.00:10;8, 1905.00:25;14, 2145.00:11;9, 2745.00:8;8, 2835.00:6;5, 2235.00:15;10, 3195.00:22;7, 1815.00:17;11, 1545.00:9;8, 3225.00:5;2, 3045.00:15;9, 2055.00:11;8, 3450.00:20;9, 615.00:174;136, 1995.00:4;4, 3315.00:4;2, 2115.00:17;8, 2655.00:6;4, 1575.00:11;5, 2085.00:15;13, 1485.00:27;18, 705.00:225;145, 2985.00:6;3, 2355.00:6;6, 1065.00:60;40, 3285.00:10;3, 2865.00:6;3, 3345.00:6;2, 1665.00:10;9, 2625.00:2;2, 1275.00:16;13, 1305.00:20;16, 795.00:506;334, 2265.00:15;9, 1095.00:46;31, 2775.00:11;6, 3570.00:10;6, 3165.00:8;3, 855.00:190;130, 3510.00:12;9, 2175.00:10;4, 675.00:184;137, 2445.00:7;5, 2805.00:8;6, 3015.00:9;6, 2415.00:9;7, 1035.00:61;41, 1005.00:85;60, 645.00:156;121, 2895.00:7;6, 1455.00:29;23, 3390.00:10;5, 2535.00:5;4, 2955.00:1;1, 2325.00:4;3, 1185.00:37;30, 1935.00:20;11, 2685.00:2;1, 3255.00:19;9, 1635.00:28;20, 945.00:175;127, 1425.00:18;13, 2925.00:9;5, 2505.00:9;5",
    ('Null', 'Leu', 'Val'): "2865.00:35;17, 3285.00:29;9, 1035.00:212;150, 2955.00:23;13, 2595.00:44;28, 2565.00:23;17, 2775.00:24;14, 1905.00:41;32, 3570.00:29;15, 3390.00:31;15, 1245.00:125;88, 2715.00:36;21, 2925.00:40;20, 2805.00:25;16, 885.00:498;297, 1155.00:157;105, 1575.00:90;58, 2085.00:38;31, 2445.00:27;21, 3345.00:61;20, 2745.00:18;14, 2385.00:30;22, 3075.00:25;11, 1335.00:69;56, 1065.00:186;126, 1395.00:69;56, 765.00:737;483, 2175.00:23;19, 3135.00:41;17, 1485.00:103;70, 2055.00:43;27, 1965.00:51;38, 3165.00:42;20, 1755.00:72;49, 1215.00:118;67, 1605.00:66;43, 615.00:634;472, 2025.00:39;32, 1455.00:131;76, 705.00:630;403, 2835.00:38;22, 3105.00:26;10, 2625.00:26;13, 825.00:728;486, 915.00:832;533, 3315.00:60;23, 675.00:559;388, 2145.00:36;27, 1185.00:93;66, 2325.00:31;19, 1125.00:156;112, 2655.00:25;15, 1935.00:34;27, 1875.00:60;46, 2475.00:25;18, 855.00:414;281, 975.00:329;233, 1845.00:45;31, 3195.00:23;11, 1515.00:98;66, 1425.00:93;63, 735.00:548;382, 2535.00:14;11, 945.00:589;409, 2295.00:31;25, 1815.00:55;34, 2685.00:16;11, 1695.00:78;58, 2415.00:27;19, 2895.00:43;24, 1545.00:75;49, 1995.00:32;25, 3255.00:36;15, 3225.00:31;13, 795.00:969;621, 1635.00:75;55, 1005.00:260;172, 2505.00:25;19, 2205.00:34;25, 3045.00:29;12, 1275.00:70;55, 2265.00:32;23, 1785.00:66;52, 1305.00:91;65, 645.00:640;451, 3450.00:23;13, 3510.00:19;11, 3015.00:39;21, 2115.00:33;29, 1725.00:50;44, 2355.00:53;34, 1665.00:58;50, 1365.00:84;66, 2985.00:39;21, 1095.00:169;104, 2235.00:40;32",
    ('Phe', 'Val', 'Null'): "645.00:268;206, 3345.00:17;6, 2445.00:6;4, 3045.00:14;5, 705.00:128;91, 2295.00:5;3, 1425.00:30;21, 885.00:174;91, 1155.00:57;37, 2025.00:8;8, 2655.00:11;4, 2085.00:9;6, 1995.00:8;5, 975.00:174;111, 3225.00:8;5, 1275.00:32;24, 3165.00:6;3, 1005.00:205;133, 765.00:133;91, 1335.00:25;19, 1575.00:23;20, 3510.00:9;6, 3315.00:7;4, 1755.00:20;15, 1035.00:99;72, 2145.00:11;8, 675.00:152;106, 1455.00:16;11, 1485.00:18;11, 1095.00:61;42, 3015.00:3;2, 2805.00:15;7, 2595.00:9;6, 1245.00:44;39, 1875.00:17;12, 1785.00:21;15, 2505.00:14;9, 2265.00:5;4, 1935.00:6;6, 1515.00:12;10, 1815.00:20;13, 945.00:110;80, 1845.00:7;5, 1635.00:26;18, 735.00:103;74, 3195.00:9;4, 2205.00:15;9, 2115.00:6;6, 615.00:336;242, 2055.00:16;9, 1395.00:15;10, 2895.00:7;6, 1305.00:39;24, 1065.00:84;60, 855.00:171;125, 1965.00:24;10, 2745.00:9;5, 3570.00:5;3, 915.00:146;95, 2685.00:5;5, 1125.00:68;50, 1905.00:14;10, 1185.00:44;33, 825.00:126;82, 2925.00:1;1, 2775.00:7;6, 1725.00:23;14, 1695.00:22;14, 2565.00:4;3, 1665.00:20;12, 1605.00:24;13, 2175.00:1;1, 1365.00:15;10, 2385.00:8;6, 2235.00:18;12, 2955.00:12;9, 3285.00:11;2, 2475.00:7;6, 3390.00:10;5, 1215.00:44;30, 2355.00:18;12, 2985.00:10;4, 3450.00:8;3, 3255.00:6;4, 2625.00:5;4, 795.00:123;78, 2865.00:13;6, 3075.00:14;4, 2415.00:5;5, 2535.00:4;3, 2325.00:12;9, 3135.00:23;10, 3105.00:4;3, 1545.00:21;17, 2715.00:5;5",
    ('Phe', 'Null', 'Val'): "2055.00:14;8, 3315.00:9;3, 3075.00:10;3, 2115.00:17;12, 2025.00:11;8, 2655.00:8;7, 3195.00:3;1, 1665.00:11;9, 2355.00:15;9, 1965.00:12;10, 1935.00:14;13, 705.00:183;111, 1485.00:22;14, 1575.00:27;20, 765.00:216;141, 3045.00:3;3, 2295.00:7;5, 2385.00:10;7, 1815.00:13;10, 2895.00:15;8, 2955.00:6;4, 2415.00:11;8, 645.00:185;133, 1875.00:23;16, 2865.00:6;3, 1635.00:27;22, 1755.00:17;11, 2715.00:8;6, 3510.00:16;9, 3225.00:1;1, 2985.00:9;5, 915.00:319;220, 3135.00:9;4, 2475.00:9;6, 1515.00:25;16, 1905.00:15;10, 1035.00:91;63, 1275.00:20;16, 2625.00:11;4, 1725.00:16;14, 885.00:376;201, 675.00:128;93, 795.00:137;87, 3450.00:7;4, 2805.00:6;5, 2505.00:11;7, 2235.00:14;11, 2205.00:23;13, 945.00:147;105, 1155.00:64;38, 3345.00:10;3, 2445.00:5;4, 1395.00:30;16, 1785.00:22;16, 3015.00:5;3, 2925.00:11;6, 1215.00:41;25, 1305.00:45;25, 1845.00:16;15, 1125.00:45;31, 2085.00:6;5, 2325.00:22;12, 1245.00:30;24, 855.00:213;149, 1365.00:19;13, 2775.00:20;10, 1695.00:11;9, 735.00:184;124, 2595.00:10;7, 2145.00:12;9, 2175.00:12;8, 3390.00:10;5, 1005.00:174;123, 1545.00:18;11, 2835.00:8;5, 1425.00:9;7, 975.00:126;87, 1605.00:30;16, 615.00:186;137, 2565.00:7;5, 2685.00:8;7, 3105.00:6;4, 3570.00:6;4, 3165.00:15;7, 1095.00:46;29, 2745.00:3;3, 1995.00:12;9, 1455.00:18;13, 825.00:122;82, 1065.00:65;46, 3285.00:21;8, 2265.00:10;7, 3255.00:10;3, 1185.00:31;22, 1335.00:33;27, 2535.00:6;6",
    ('Null', 'Phe', 'Val'): "3045.00:22;13, 1485.00:107;77, 1155.00:199;138, 1785.00:82;60, 2805.00:34;18, 1095.00:168;114, 2565.00:34;25, 1335.00:116;78, 2475.00:45;32, 2955.00:43;27, 3195.00:54;22, 2415.00:35;27, 1455.00:97;72, 1605.00:78;57, 1065.00:275;193, 2385.00:37;24, 3285.00:29;13, 1515.00:91;63, 1245.00:152;111, 3450.00:39;19, 1905.00:46;33, 1935.00:59;45, 2625.00:19;11, 2985.00:32;18, 1755.00:65;49, 1305.00:95;71, 2235.00:38;30, 1005.00:588;404, 3390.00:59;27, 2115.00:65;43, 885.00:1123;636, 825.00:539;367, 2445.00:34;25, 1845.00:48;39, 1575.00:119;84, 2715.00:24;15, 2535.00:25;23, 2865.00:34;17, 1665.00:84;62, 3510.00:35;17, 2265.00:47;34, 2055.00:53;43, 3135.00:45;28, 3075.00:21;13, 975.00:455;315, 615.00:800;592, 2655.00:27;22, 1695.00:94;65, 3015.00:31;22, 1635.00:84;60, 2745.00:39;25, 1215.00:130;92, 3345.00:35;15, 1725.00:90;67, 2025.00:45;36, 645.00:704;514, 3315.00:55;18, 3570.00:59;30, 2355.00:26;21, 3105.00:29;18, 1185.00:125;92, 675.00:597;419, 3225.00:54;22, 1395.00:111;74, 1815.00:59;42, 2145.00:55;37, 705.00:696;451, 1875.00:57;46, 795.00:516;356, 1275.00:90;71, 1425.00:118;74, 3165.00:26;18, 2205.00:63;39, 3255.00:46;21, 1125.00:184;126, 2835.00:34;17, 945.00:433;287, 1545.00:87;68, 2505.00:39;29, 1365.00:98;69, 2775.00:42;31, 2685.00:39;28, 2325.00:45;33, 2175.00:35;20, 2595.00:44;27, 2085.00:57;42, 2895.00:27;17, 735.00:670;457, 915.00:871;580, 2925.00:32;19, 1995.00:61;41, 2295.00:66;41, 1035.00:332;227, 855.00:757;487, 765.00:592;398, 1965.00:77;43",
    ('Leu', 'Null', 'Null'): "1035.00:31;23, 1605.00:6;6, 1125.00:27;17, 1245.00:30;19, 645.00:91;60, 3135.00:5;3, 2415.00:5;4, 2985.00:6;3, 1755.00:11;8, 1995.00:7;6, 1275.00:14;11, 2025.00:14;8, 3105.00:6;4, 2085.00:10;6, 2805.00:10;6, 1875.00:15;8, 3315.00:7;5, 1155.00:26;19, 1515.00:7;7, 705.00:159;103, 1965.00:4;3, 675.00:120;93, 1335.00:13;12, 1695.00:12;9, 2535.00:7;4, 765.00:227;146, 1785.00:8;8, 1665.00:4;4, 2955.00:4;3, 1425.00:9;6, 1365.00:12;11, 1305.00:13;11, 1935.00:20;11, 1815.00:11;8, 3390.00:6;4, 1185.00:34;20, 945.00:61;46, 2295.00:6;4, 1725.00:8;6, 1845.00:6;6, 1395.00:17;10, 3045.00:3;2, 1005.00:49;33, 1065.00:30;22, 2325.00:6;5, 2715.00:9;5, 735.00:86;65, 2895.00:2;2, 2355.00:8;6, 3165.00:10;5, 2565.00:2;2, 3075.00:3;2, 2175.00:13;6, 1455.00:10;9, 2055.00:7;4, 2835.00:3;2, 2205.00:3;3, 3225.00:17;5, 1215.00:13;12, 2655.00:6;5, 1575.00:7;6, 2865.00:17;6, 2385.00:6;6, 2475.00:1;1, 855.00:104;64, 2265.00:4;4, 1095.00:28;18, 3195.00:13;3, 885.00:88;52, 1545.00:7;5, 915.00:78;61, 975.00:43;32, 3570.00:2;2, 3345.00:2;1, 2115.00:10;5, 2745.00:9;5, 795.00:301;195, 825.00:192;141, 3510.00:4;3, 1635.00:9;8, 2685.00:7;5, 1905.00:6;5, 3255.00:2;1, 3450.00:1;1, 3285.00:4;2, 615.00:56;47, 2505.00:2;2, 2235.00:5;3, 2145.00:7;4, 2775.00:5;4, 2445.00:2;2, 1485.00:13;9, 2925.00:9;6, 2625.00:5;2, 3015.00:5;5",
    ('Null', 'Leu', 'Null'): "1005.00:107;75, 735.00:282;188, 885.00:190;98, 1365.00:62;46, 1095.00:74;48, 2895.00:11;9, 1065.00:91;65, 795.00:360;244, 765.00:337;225, 855.00:177;111, 1215.00:61;37, 3255.00:10;7, 2355.00:25;14, 1395.00:51;40, 2025.00:13;10, 2505.00:15;7, 2205.00:18;15, 675.00:248;173, 3285.00:12;7, 1545.00:48;36, 2865.00:11;7, 825.00:266;173, 2835.00:30;14, 3195.00:30;8, 3510.00:16;9, 2595.00:18;13, 2775.00:15;8, 2115.00:23;16, 2145.00:12;8, 1035.00:76;62, 2805.00:14;8, 2625.00:12;8, 1185.00:45;35, 2655.00:11;8, 1155.00:71;50, 2325.00:20;12, 1275.00:29;23, 3390.00:28;8, 2565.00:16;11, 2235.00:13;9, 1875.00:14;13, 1785.00:36;21, 2175.00:6;5, 2415.00:15;12, 1575.00:69;48, 1905.00:31;24, 1125.00:81;52, 1995.00:14;13, 645.00:212;159, 705.00:267;175, 3570.00:10;8, 1305.00:54;38, 2745.00:24;17, 915.00:149;98, 2985.00:18;14, 1665.00:40;32, 3015.00:18;10, 2445.00:16;10, 1245.00:46;34, 2715.00:14;10, 2955.00:12;5, 1485.00:42;38, 1635.00:22;21, 2475.00:7;6, 1935.00:26;15, 1455.00:52;39, 615.00:159;129, 2085.00:24;15, 2295.00:6;6, 2055.00:13;10, 945.00:142;98, 1725.00:25;22, 2535.00:11;9, 1515.00:64;51, 3165.00:20;10, 3135.00:20;14, 1335.00:50;34, 2385.00:11;7, 2265.00:20;13, 1965.00:25;19, 2685.00:16;9, 3315.00:19;7, 1695.00:43;32, 3075.00:11;4, 1425.00:42;28, 1755.00:19;17, 3345.00:31;8, 2925.00:13;9, 3105.00:7;3, 1815.00:23;18, 1605.00:46;31, 975.00:96;69, 3225.00:7;5, 1845.00:22;18, 3450.00:12;8, 3045.00:17;9",
    ('Null', 'Null', 'Leu'): "1275.00:77;58, 645.00:372;251, 2085.00:44;26, 3105.00:28;16, 885.00:206;109, 3390.00:38;17, 2835.00:17;13, 3165.00:23;13, 2295.00:28;17, 3075.00:11;6, 855.00:268;182, 2865.00:21;14, 1875.00:50;32, 1845.00:39;30, 1125.00:150;96, 2205.00:27;22, 1155.00:129;70, 2655.00:27;19, 1395.00:71;54, 2625.00:25;12, 1215.00:99;70, 1665.00:79;51, 2745.00:19;12, 675.00:440;312, 2475.00:21;16, 1575.00:73;53, 2565.00:35;21, 2385.00:23;18, 1815.00:47;34, 1485.00:98;68, 2175.00:27;19, 2235.00:32;22, 2355.00:35;26, 3015.00:32;13, 795.00:945;598, 2415.00:35;27, 1635.00:72;58, 2925.00:34;14, 975.00:110;74, 1905.00:40;29, 3450.00:40;21, 1335.00:64;47, 2805.00:25;18, 1095.00:141;99, 2145.00:35;26, 2325.00:38;30, 2265.00:28;21, 1995.00:40;34, 1695.00:65;45, 2535.00:24;17, 2055.00:41;29, 1605.00:74;57, 1455.00:77;58, 2775.00:33;21, 945.00:175;121, 1365.00:70;53, 615.00:265;181, 1425.00:77;57, 1035.00:133;92, 825.00:527;341, 1545.00:61;44, 1515.00:81;53, 705.00:555;347, 915.00:199;128, 1785.00:61;43, 2715.00:13;10, 765.00:780;495, 3345.00:27;10, 1965.00:44;30, 2445.00:15;11, 3285.00:40;13, 3570.00:38;19, 3510.00:25;12, 3195.00:27;10, 735.00:461;309, 3225.00:29;9, 1245.00:114;86, 3135.00:15;8, 1005.00:154;106, 2955.00:14;8, 2685.00:23;15, 1755.00:47;33, 2505.00:16;14, 1065.00:171;105, 3315.00:9;6, 2595.00:31;20, 2895.00:22;13, 1305.00:94;68, 2115.00:34;20, 1935.00:45;31, 2985.00:30;19, 3045.00:24;13, 3255.00:25;13, 1185.00:97;69, 2025.00:25;19, 1725.00:49;40",
    ('Phe', 'Null', 'Null'): "3075.00:6;2, 1635.00:17;14, 2895.00:9;5, 1455.00:15;14, 2775.00:9;6, 645.00:102;71, 1965.00:13;8, 2835.00:5;3, 1785.00:20;15, 1935.00:19;13, 1065.00:34;22, 2205.00:12;6, 1365.00:11;9, 2535.00:7;5, 1995.00:10;8, 765.00:163;103, 3285.00:9;6, 3225.00:13;6, 1575.00:17;14, 3450.00:7;4, 1485.00:17;14, 2985.00:6;5, 735.00:174;113, 2475.00:8;6, 1515.00:11;11, 705.00:119;79, 2925.00:4;4, 2085.00:12;10, 3570.00:4;3, 945.00:95;72, 1305.00:33;20, 1695.00:10;9, 2865.00:4;3, 2145.00:13;6, 1905.00:9;9, 3255.00:8;4, 1725.00:12;8, 2115.00:16;10, 1605.00:21;14, 3135.00:3;3, 3510.00:2;2, 2715.00:12;6, 1245.00:31;22, 2055.00:4;4, 3390.00:17;7, 2565.00:3;2, 1185.00:21;18, 2385.00:10;6, 975.00:77;55, 855.00:230;156, 615.00:94;71, 3045.00:7;7, 2685.00:11;8, 1125.00:35;26, 3345.00:8;5, 1155.00:19;12, 1005.00:89;54, 1815.00:11;10, 3105.00:11;4, 2625.00:6;4, 2655.00:5;3, 1215.00:22;16, 915.00:234;156, 3315.00:5;3, 2295.00:10;7, 2445.00:5;5, 2505.00:6;4, 1755.00:11;8, 1545.00:11;10, 1275.00:18;16, 1095.00:57;40, 2955.00:10;4, 2595.00:12;10, 1335.00:27;21, 2805.00:17;8, 885.00:359;199, 2265.00:8;5, 1665.00:13;9, 2355.00:8;7, 3195.00:19;4, 1035.00:49;36, 1425.00:16;10, 2025.00:12;10, 1875.00:9;7, 2235.00:8;7, 3015.00:7;4, 825.00:133;95, 2325.00:8;6, 795.00:107;75, 2745.00:5;4, 2415.00:8;5, 1395.00:20;18, 3165.00:16;11, 675.00:121;90, 1845.00:12;9, 2175.00:2;1",
    ('Null', 'Phe', 'Null'): "2985.00:28;16, 1125.00:91;69, 795.00:390;265, 2955.00:33;21, 1095.00:116;86, 2805.00:35;26, 2685.00:15;10, 2475.00:32;20, 735.00:391;275, 2925.00:16;10, 3570.00:16;12, 915.00:372;270, 675.00:435;301, 1335.00:78;58, 885.00:693;379, 2625.00:13;10, 855.00:551;351, 1575.00:81;58, 1215.00:82;59, 2055.00:40;31, 1815.00:51;32, 2385.00:30;18, 2445.00:15;10, 3510.00:30;14, 1665.00:60;48, 3195.00:32;14, 1275.00:70;55, 825.00:488;307, 1725.00:64;51, 2895.00:16;8, 2145.00:41;30, 2025.00:33;26, 2505.00:39;28, 2415.00:37;25, 765.00:403;269, 2295.00:38;27, 1005.00:230;158, 2085.00:34;29, 945.00:238;153, 2835.00:43;19, 2565.00:38;25, 1515.00:63;49, 1425.00:89;62, 2325.00:33;22, 3255.00:32;13, 2235.00:21;15, 2115.00:40;26, 1485.00:87;65, 1455.00:94;64, 3165.00:32;15, 2205.00:36;30, 975.00:179;124, 1305.00:86;65, 1995.00:55;35, 2355.00:29;22, 1605.00:55;44, 705.00:475;297, 1695.00:69;50, 2715.00:24;15, 2595.00:31;20, 1395.00:84;62, 1965.00:40;29, 1875.00:46;38, 1155.00:128;93, 1845.00:32;26, 1035.00:147;101, 1785.00:64;48, 3450.00:25;15, 2655.00:26;18, 1905.00:48;34, 1365.00:59;47, 3045.00:22;13, 1185.00:93;66, 3345.00:20;9, 3315.00:21;11, 1755.00:55;45, 2175.00:27;19, 1935.00:53;38, 2265.00:25;16, 3285.00:48;15, 1065.00:160;115, 645.00:410;303, 2865.00:29;15, 1245.00:88;58, 3135.00:35;17, 3015.00:25;15, 2745.00:20;17, 2535.00:19;14, 1545.00:81;56, 3105.00:26;14, 2775.00:36;22, 3225.00:16;8, 1635.00:71;53, 615.00:330;247, 3390.00:14;9, 3075.00:32;12",
    ('Null', 'Null', 'Phe'): "3255.00:31;13, 1605.00:77;54, 2055.00:34;25, 3570.00:19;9, 2535.00:16;12, 2805.00:35;21, 975.00:166;101, 2475.00:36;21, 2415.00:38;24, 1335.00:65;52, 2775.00:25;17, 2385.00:28;17, 3075.00:19;10, 885.00:542;281, 3345.00:30;9, 2325.00:33;24, 1095.00:126;85, 615.00:297;226, 2505.00:13;13, 675.00:380;262, 645.00:311;240, 855.00:379;258, 1965.00:43;29, 1035.00:156;112, 1905.00:36;27, 3045.00:22;11, 945.00:197;133, 735.00:347;234, 1005.00:134;93, 1815.00:26;21, 1755.00:42;35, 2715.00:15;8, 1155.00:136;93, 1185.00:85;65, 1875.00:40;28, 3390.00:24;13, 1575.00:71;50, 2445.00:21;13, 1215.00:103;69, 2205.00:26;19, 1245.00:115;81, 765.00:299;203, 1365.00:53;41, 1065.00:120;91, 1785.00:54;36, 3135.00:26;10, 3105.00:23;11, 2115.00:30;24, 2025.00:28;22, 1545.00:80;56, 2145.00:39;26, 2985.00:29;16, 1845.00:52;42, 1305.00:88;61, 2355.00:28;22, 915.00:346;219, 2625.00:11;7, 1515.00:90;63, 2955.00:24;18, 3195.00:29;14, 1695.00:64;44, 3450.00:17;10, 1455.00:81;59, 795.00:317;211, 3015.00:21;10, 1395.00:67;46, 1935.00:35;21, 2235.00:33;22, 2175.00:19;13, 3510.00:21;11, 2895.00:19;13, 1485.00:65;43, 1425.00:65;46, 2655.00:31;20, 1725.00:41;26, 2085.00:46;34, 2685.00:10;8, 2565.00:15;12, 3285.00:31;9, 3225.00:22;14, 2295.00:27;21, 2265.00:26;18, 2595.00:24;16, 1125.00:131;83, 2865.00:15;8, 2745.00:25;15, 2925.00:24;15, 1635.00:61;44, 825.00:351;235, 1665.00:41;35, 3165.00:19;10, 3315.00:13;5, 1275.00:64;53, 1995.00:34;28, 2835.00:23;17, 705.00:365;229",
    ('Val', 'Null', 'Null'): "2115.00:4;3, 3285.00:4;2, 1305.00:12;7, 2985.00:2;2, 2145.00:4;4, 675.00:67;48, 3105.00:4;3, 3390.00:4;2, 2025.00:2;2, 1215.00:25;13, 1335.00:6;6, 765.00:132;96, 2265.00:8;4, 1485.00:6;5, 3450.00:2;2, 1155.00:12;11, 915.00:20;15, 1245.00:12;9, 1935.00:7;5, 795.00:84;51, 885.00:37;24, 735.00:168;115, 705.00:107;72, 975.00:17;13, 945.00:20;14, 855.00:34;27, 2235.00:5;5, 1665.00:9;8, 1065.00:9;8, 1575.00:4;4, 1035.00:13;12, 2715.00:6;4, 1275.00:8;5, 2175.00:5;3, 2355.00:2;1, 1635.00:1;1, 1815.00:1;1, 3135.00:5;1, 2745.00:6;4, 1995.00:9;5, 645.00:44;34, 2445.00:1;1, 2385.00:2;1, 2805.00:9;4, 2955.00:2;1, 1515.00:8;7, 2085.00:6;5, 3225.00:2;2, 2625.00:1;1, 825.00:60;46, 1545.00:4;3, 1125.00:8;7, 2925.00:2;2, 2685.00:2;2, 1755.00:7;4, 2565.00:1;1, 615.00:33;25, 1785.00:1;1, 3045.00:8;3, 1365.00:5;3, 1455.00:7;4, 2505.00:2;2, 3015.00:8;4, 2775.00:2;2, 2835.00:4;2, 2055.00:3;2, 3315.00:4;2, 1395.00:11;9, 2895.00:4;3, 3255.00:8;3, 2535.00:2;1, 1185.00:12;8, 1725.00:5;3, 1875.00:1;1, 1095.00:14;12, 1695.00:5;4, 2865.00:2;1, 1425.00:13;6, 1965.00:1;1, 2415.00:1;1, 1005.00:21;15, 3345.00:7;2, 1845.00:3;3, 2295.00:4;4, 2655.00:5;4, 1905.00:2;1, 1605.00:3;3",
    ('Null', 'Val', 'Null'): "3015.00:21;11, 1305.00:54;37, 705.00:235;156, 1095.00:60;34, 1455.00:53;40, 3285.00:16;5, 2835.00:11;6, 2085.00:19;10, 2205.00:12;9, 1785.00:21;13, 2265.00:9;5, 1845.00:10;7, 1185.00:57;41, 2805.00:19;9, 1245.00:60;40, 1545.00:26;19, 3345.00:8;6, 1935.00:21;15, 2865.00:10;5, 675.00:177;129, 1365.00:59;41, 3510.00:10;8, 3195.00:7;4, 2475.00:12;9, 3135.00:19;9, 2685.00:7;4, 765.00:187;124, 795.00:127;83, 1035.00:64;41, 2415.00:5;5, 2715.00:7;5, 2985.00:11;7, 1695.00:25;18, 3390.00:12;6, 1065.00:57;49, 3450.00:24;11, 885.00:61;36, 2115.00:12;10, 1005.00:63;44, 1635.00:26;23, 3165.00:15;7, 3225.00:42;11, 2445.00:3;3, 1155.00:69;44, 3255.00:7;2, 2295.00:15;10, 1125.00:61;38, 2925.00:11;7, 2745.00:6;5, 975.00:60;41, 2625.00:6;5, 735.00:238;181, 2145.00:6;4, 915.00:47;41, 1395.00:27;18, 1335.00:43;35, 2025.00:18;11, 1275.00:47;37, 1425.00:51;35, 1965.00:20;11, 1605.00:17;15, 2895.00:10;5, 2955.00:2;1, 1485.00:32;26, 825.00:154;98, 1515.00:47;33, 2325.00:17;12, 2595.00:8;7, 1905.00:12;9, 1875.00:14;10, 645.00:174;125, 2385.00:11;8, 1755.00:15;11, 3045.00:17;5, 3105.00:13;8, 1725.00:36;25, 2175.00:8;6, 1215.00:83;48, 3315.00:8;3, 2055.00:13;9, 2775.00:17;10, 615.00:128;94, 2235.00:7;7, 3570.00:8;5, 3075.00:3;1, 2355.00:17;13, 2535.00:11;7, 1995.00:25;15, 2505.00:7;6, 1815.00:31;16, 2655.00:13;7, 945.00:56;42, 1665.00:25;16, 1575.00:32;22, 855.00:96;66, 2565.00:5;4",
    ('Null', 'Null', 'Val'): "2265.00:16;10, 3135.00:34;13, 1395.00:62;47, 2175.00:23;16, 885.00:139;79, 1665.00:48;32, 1215.00:84;59, 1935.00:29;20, 2625.00:16;7, 1065.00:120;78, 1005.00:129;92, 915.00:158;112, 1875.00:42;33, 1575.00:63;40, 1335.00:56;47, 2745.00:24;16, 2295.00:30;19, 3450.00:24;13, 2895.00:16;10, 2085.00:31;21, 2355.00:15;12, 705.00:724;454, 3045.00:16;9, 735.00:706;478, 615.00:304;226, 675.00:458;306, 2865.00:11;7, 2475.00:14;10, 645.00:403;281, 2955.00:26;15, 2805.00:35;16, 1245.00:112;78, 2385.00:18;15, 2505.00:23;14, 1965.00:26;19, 2535.00:18;11, 765.00:473;306, 1425.00:69;48, 1095.00:127;85, 3510.00:34;12, 1365.00:61;45, 1545.00:38;26, 1455.00:63;44, 3285.00:25;7, 1035.00:121;80, 2415.00:31;21, 1725.00:43;34, 3105.00:23;17, 1815.00:50;33, 2445.00:22;15, 3570.00:24;14, 3255.00:18;11, 975.00:126;82, 1485.00:47;38, 2655.00:23;14, 2145.00:31;18, 2115.00:21;19, 2025.00:28;20, 2325.00:22;21, 1515.00:53;43, 1635.00:46;36, 3345.00:22;9, 1845.00:35;23, 2985.00:16;11, 2595.00:25;14, 3315.00:22;11, 2925.00:18;12, 855.00:144;93, 825.00:198;126, 945.00:125;90, 2835.00:15;9, 1155.00:110;82, 2565.00:10;9, 3165.00:21;11, 1125.00:153;106, 2205.00:30;20, 3390.00:18;9, 1275.00:78;53, 2055.00:28;26, 1185.00:109;75, 3015.00:15;8, 2235.00:20;15, 2685.00:11;8, 795.00:229;156, 3195.00:14;7, 1755.00:31;23, 1785.00:40;22, 2715.00:27;20, 2775.00:20;13, 1305.00:59;41, 1905.00:34;21, 1995.00:35;25, 1695.00:49;32, 1605.00:49;39, 3075.00:26;11, 3225.00:17;6",
    ('Null', 'Null', 'Null'): "3450.00:7;3, 2325.00:14;11, 1605.00:11;10, 825.00:74;53, 1875.00:15;11, 2955.00:22;8, 885.00:88;41, 975.00:43;31, 3315.00:4;3, 1455.00:21;17, 2985.00:8;5, 1635.00:9;7, 2145.00:10;4, 3135.00:4;3, 2355.00:13;10, 1125.00:63;48, 1335.00:35;22, 1275.00:61;44, 1515.00:19;13, 855.00:81;52, 1965.00:10;8, 2175.00:4;3, 1485.00:21;12, 1395.00:36;24, 2025.00:10;7, 1815.00:6;6, 1035.00:53;44, 1845.00:12;10, 2685.00:7;4, 2205.00:10;9, 795.00:80;50, 1725.00:21;16, 3045.00:7;4, 915.00:51;33, 2865.00:5;3, 2505.00:10;7, 615.00:154;117, 1575.00:21;14, 705.00:129;76, 675.00:138;108, 1365.00:14;12, 945.00:50;33, 2415.00:14;8, 645.00:178;133, 1425.00:30;18, 2895.00:9;8, 2835.00:8;5, 1065.00:74;52, 2445.00:7;7, 1215.00:62;51, 1155.00:73;42, 3570.00:2;2, 2235.00:9;8, 2085.00:14;10, 2535.00:3;3, 1305.00:56;37, 765.00:84;57, 3510.00:3;2, 2565.00:5;4, 1665.00:14;12, 2595.00:6;4, 2715.00:5;4, 1695.00:11;9, 3255.00:13;7, 2385.00:13;10, 1095.00:59;44, 2115.00:8;7, 3075.00:2;1, 1755.00:9;6, 3225.00:1;1, 2745.00:13;6, 3015.00:11;6, 2925.00:13;6, 1245.00:81;48, 3285.00:11;4, 1785.00:17;13, 2805.00:5;2, 2295.00:7;6, 2265.00:8;6, 3345.00:7;4, 1995.00:16;10, 1935.00:13;7, 3165.00:10;4, 2475.00:5;5, 735.00:97;70, 1185.00:48;36, 1545.00:17;12, 1905.00:16;11, 2625.00:3;2, 1005.00:74;50, 3105.00:6;5, 2055.00:18;12, 2775.00:1;1, 2655.00:10;8, 3195.00:14;5, 3390.00:5;3"
}

def process_chromatography_data(data_str: str) -> Tuple[np.ndarray, np.ndarray]:
    """Convert string data to sorted time and intensity arrays"""
    # Split the data points
    points = data_str.split(',')
    times = []
    intensities = []

    # Process each point
    for point in points:
        point = point.strip()
        if not point:
            continue
        # Split into time and intensity parts
        time_intensity = point.split(':')
        time = float(time_intensity[0])
        # Take the first intensity value if there are multiple
        intensity = float(time_intensity[1].split(';')[0])
        times.append(time)
        intensities.append(intensity)

    # Convert to numpy arrays and sort by time
    times = np.array(times)
    intensities = np.array(intensities)
    sort_idx = np.argsort(times)

    return times[sort_idx], intensities[sort_idx]

def create_sequence_from_tuple(sequence_tuple: Tuple[str, ...]) -> List[str]:
    """Convert sequence tuple to list, replacing 'Null' with 'N'"""
    return [s if s != 'Null' else 'N' for s in sequence_tuple]

def test_sgppm_hierarchical():
    # Create chromatograms for each sequence in the hierarchy
    chromatograms = []

    for sequence, data in hierarchy_data.items():
        # Process the chromatography data
        data = data.replace(";", ":")  # Standardize separators
        times, intensities = process_chromatography_data(data)

        # Convert sequence tuple to BuildingBlock objects
        building_blocks = [
            BuildingBlock(name=block) if block != 'Null' else BuildingBlock(name='N')
            for block in sequence
        ]

        # Create chromatogram with building blocks
        chrom = Chromatogram(
            x=times,
            y=intensities,
            building_blocks=building_blocks
        )
        chromatograms.append(chrom)

    # Create and run the hierarchical peak picking model
    config = SGPPMConfig()
    peak_picking_model = HierarchicalSimpleGaussianPeakPickingModel(config=config)

    # Process all chromatograms hierarchically
    processed_chromatograms = peak_picking_model.pick_peaks(chromatograms=chromatograms)

    # Optional: Print results for verification
    for chrom in processed_chromatograms:
        sequence_str = ''.join(bb.name for bb in chrom.building_blocks)
        if chrom.picked_peak:
            peak_time = chrom.picked_peak.peak_metrics['time']
            peak_height = chrom.picked_peak.peak_metrics['height']
            print(f"Sequence: {sequence_str}, Peak Time: {peak_time:.2f}, Height: {peak_height:.2f}")
        else:
            print(f"Sequence: {sequence_str}, No peak picked")

    return processed_chromatograms

def process_chromatography_data(data_str: str) -> Tuple[np.ndarray, np.ndarray]:
    """Convert string data to sorted time and intensity arrays"""
    # Split the data points
    points = data_str.split(',')
    times = []
    intensities = []

    # Process each point
    for point in points:
        point = point.strip()
        if not point:
            continue
        # Split into time and intensity parts
        time_intensity = point.split(':')
        time = float(time_intensity[0])
        # Take the first intensity value if there are multiple
        intensity = float(time_intensity[1].split(';')[0])
        times.append(time)
        intensities.append(intensity)

    # Convert to numpy arrays and sort by time
    times = np.array(times)
    intensities = np.array(intensities)
    sort_idx = np.argsort(times)

    return times[sort_idx], intensities[sort_idx]

# Run the test
if __name__ == "__main__":
    chromatograms = test_sgppm_hierarchical()
